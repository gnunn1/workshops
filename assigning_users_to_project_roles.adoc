== Assigning Users to Project Roles

In this lab you will learn how to grant user access to different
projects. This will get you familiar with how to enable colaboration
within the OpenShift platform.

=== Step 1

As an admin (or another user), create a project and an app within
that project.

....
# oc whoami
userXX
....

NOTE: When creating the project please replace the XX in projectXX with the
number assigned to you by the instructor.

....
# oc new-project projectXX
Now using project "projectXX" on server "https://10.0.0.4:8443".

You can add applications to this project with the 'new-app' command. For example, try:

    oc new-app centos/ruby-22-centos7~https://github.com/openshift/ruby-ex.git

to build a new example application in Ruby.
....

....
# oc project projectXX
Already on project "projectXX" on server "https://10.0.0.4:8443"

# oc new-app redhatworkshops/welcome-php --name=welcome-php
--> Found Docker image 3e73433 (7 months old) from Docker Hub for "redhatworkshops/welcome-php"

    chx/welcome-php-1:b68a2d86
    --------------------------
    Platform for building and running PHP 5.6 applications

    Tags: builder, php, php56, rh-php56

    * An image stream will be created as "welcome-php:latest" that will track this image
    * This image will be deployed in deployment config "welcome-php"
    * Port 8080/tcp will be load balanced by service "welcome-php"
      * Other containers can access this service through the hostname "welcome-php"

--> Creating resources ...
    imagestream "welcome-php" created
    deploymentconfig "welcome-php" created
    service "welcome-php" created
--> Success
    Run 'oc status' to view your app.
....

Now, as `user1XX`, login to the webui. You should be presented with a
``blank slate'' after you login i.e, you won’t see any projects.

image:openshift-overview-user-1.png[image]

=== Step 2

Now we will assign the user `user1XX` to be able to view the project
`projectXX`. We will do this with the `oc policy` command as the
project admin user.

....
# oc whoami
userXX
....

....
# oc policy add-role-to-user view user1XX -n project1
role "view" added: "user1XX"
....

*NOTE:* Use `oc policy -h` to view all the options

Take a look at the webpage now; you should see the project ``project1''
(feel free to click around).

image:user-1-myproject.png[image]

Once you have explored; go back to the overviewpage

Remove the ``view'' role and see the project ``projectXX'' no longer
appears on the project list

....
# oc policy remove-role-from-user view user1XX -n project1
role "view" removed: "user1XX"
....

image:user1-noview.png[image]

=== Step 3

Now you will grant the ``edit'' role to `user1XX` (this supersedes any
prior policy).

....
# oc policy add-role-to-user edit user1XX -n project1
role "edit" added: "user1XX"
....

If you view the project overview page; you can see that you can scale
up/down the application (noted with the ▲ and ▼ symbols) now that you
have ``edit'' privilages

image:user-1-edit.png[image]

=== Step 4

You have edit privlages for the project; but only an admin of a project
can delete a project. If you try and delete the project, you will get
the following error.

image:user-1-nodelete.png[image]

Grant the ``admin'' role to the user

....
# oc policy add-role-to-user admin user1XX -n project1
role "admin" added: "user1XX"
....

Go ahead and delete this project (which deletes ALL applications and
resources under the project so *MAKE SURE THIS IS WHAT YOU WANT*).

image:user1-yesdelete.png[image]

=== Conclusion

In this lab you learned how to assign and remove roles to users for
specific projects. You also got familiar with what the default roles
allows and what they do not allow you to do
